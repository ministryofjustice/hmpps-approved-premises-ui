{% from "govuk/components/table/macro.njk" import govukTable %}
{% from "govuk/components/back-link/macro.njk" import govukBackLink %}

{%- from "moj/components/identity-bar/macro.njk" import mojIdentityBar -%}

{% extends "../../../partials/layout.njk" %}

{% set pageTitle = applicationName + " - " + pageHeading %}
{% set premisesLink = paths.premises.show({ premisesId: premises.id }) %}

{% block beforeContent %}
    {{ govukBackLink({
        text: "Back",
        href: premisesLink
    }) }}
{% endblock %}

{% block content %}
    {% set headingHtml %}
        <span class="govuk-caption-l">
            <a href="{{ premisesLink }}">{{ premises.name }}</a>
        </span>
        <h1 class="govuk-heading-l">{{ pageHeading }}</h1>
    {% endset %}

    {{ mojIdentityBar({
        title: {
            html: headingHtml
        },
        menus: [{
            items: [ {
                text: "Manage out of service beds",
                classes: "govuk-button--secondary",
                href: paths.outOfServiceBeds.premisesIndex({ premisesId: premises.id, temporality: 'current' })
            }]
        }]
    }) }}

    {{ govukTable({
        captionClasses: "govuk-table__caption--m",
        firstCellIsHeader: true,
        head: [
            {
                text: "Room Name"
            },
            {
                text: "Bed Name"
            },
            {
                text: 'Action'
            }
        ],
        rows: BedUtils.bedTableRows(beds, premises.id, user)
    }) }}
{% endblock %}

{% block extraScripts %}
    <script type="text/javascript" nonce="{{ cspNonce }}">
      new MOJFrontend.ButtonMenu({
        container: $('.moj-button-menu'),
        mq: '(min-width: 200em)',
        buttonText: 'Actions',
        menuClasses: 'moj-button-menu__wrapper--right',
      })
    </script>
{% endblock %}
